PAGE 60,132

TITLE   P11SELMU (EXE)

.MODEL SMALL
.STACK 64

.DATA
TOPROW EQU 00
BOTROW EQU 07
LEFCOL EQU 16
COL DB 00
ROW DB 00
COUNT DB ?
LINES DB ?
ATTRIB DB ?
NINTEEN DB 19
MENU DB 0C9H, 17 DUP(0CDH), 0BBH
DB 0BAH, ' Add records     ', 0BAH
DB 0BAH, ' Delete records  ', 0BAH
DB 0BAH, ' Enter orders    ', 0BAH
DB 0BAH, ' Print report    ', 0BAH
DB 0BAH, ' Update records  ', 0BAH
DB 0BAH, ' View records    ', 0BAH
DB 0C8H, 17 DUP(0CDH), 0BCH
PROMPT DB 09, 'To select an item, use up/down arrow'
DB ' and press Enter.'
DB 13, 10, 09, 'Press Esc to exit$'


BEGIN PROC FAR
MOV AX, @DATA
MOV DS, AX
MOV ES, AX
CALL Q10CLR
MOV ROW, BOTROW + 2
MOV COL, 00
CALL Q20CURS
MOV AH, 40H
MOV BX, 01
MOV CX, 75
LEA DX, PROMPT
INT 21H
A10LOOP:
CALL B10MENU
MOV COL, LEFCOL+1
CALL Q20CURS
MOV ROW, TOPROW+1
MOV ATTRIB,16H
CALL H10DISP
CALL D10INPT
CMP AL, 0DH
JE A10LOOP
MOV AX, 0600H
CALL Q10CLR
MOV AX, 4C00H
INT 21H
BEGIN ENDP

B10MENU PROC NEAR
MOV ROW, TOPROW
MOV LINES, 08
LEA SI, MENU
MOV ATTRIB, 71H
B20:
MOV COL, LEFCOL
MOV COUNT, 19
B30:
CALL Q20CURS
MOV AH, 09H
MOV AL, [SI]
MOV BH, 00
MOV BL, 71H
MOV CX, 01
INT 10H
INC COL
INC SI
DEC COUNT
JNZ B30
INC ROW
DEC LINES
JNZ B20
RET
B10MENU ENDP

D10INPT PROC NEAR
MOV AH, 1
INT 16H
MOV AH, BH
MOV AH, 0
INT 16H
MOV BH, AH
CMP AH, 50H
JE D20
CMP AH, 48H
JE D30
CMP AL, 0DH
JE D90
CMP AL, 1BH
JE D90
JMP D10INPT
D20: MOV ATTRIB, 71H
CALL H10DISP
INC ROW
CMP ROW, BOTROW-1
JBE D40
MOV ROW, TOPROW+1
JMP D40
D30: MOV ATTRIB, 71H
CALL H10DISP
DEC ROW
CMP ROW, TOPROW+1
JAE D40
MOV ROW, BOTROW-1
D40: CALL Q20CURS
MOV ATTRIB, 16H
CALL H10DISP
JMP D10INPT
D90: RET
D10INPT ENDP


H10DISP PROC NEAR
MOV AH, 00
MOV AL, ROW
MUL NINTEEN
LEA SI, MENU+1
ADD SI, AX
MOV COUNT, 17
H20:
CALL Q20CURS
MOV AH, 09H
MOV AL, [SI]
MOV BH, 00
MOV BL, ATTRIB
MOV CX, 01
INT 10H
INC COL
INC SI
DEC COUNT
JNZ H20
MOV COL, LEFCOL+1
CALL Q20CURS
RET
H10DISP ENDP

Q10CLR  PROC NEAR
MOV AX,0600H
MOV BH,61H
MOV CX, 0000H
MOV DX,184FH
INT 10H
Q10CLR ENDP

Q20CURS PROC NEAR
MOV AH, 02H
MOV BH, 00H
MOV DH, ROW
MOV DL, COL
INT 10H
RET
Q20CURS ENDP

END BEGIN




; [SOURCE]: D:\emu8086\emu8086\MySource\PROG12.asm
